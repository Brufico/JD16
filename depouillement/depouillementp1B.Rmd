---
title: "Depouillement de l'enquête Jeunes diplômés Ipag 2015"
author: "Bruno Fischer"
date: "27 juin 2016"
output:
  html_document:
    css: customex2.css
    number_sections: yes
    theme: readable
  word_document:
    fig_caption: yes
    fig_width: 7
    toc: yes
subtitle: Dépouillement question par question, partie 1 = Données + Pour commencer
---


```{r init, include=FALSE}
library(knitr)
opts_chunk$set(echo = FALSE)
# opts_chunk$set(echo = FALSE, fig.width = 5, fig.height = 5)
options(digits = 2, scipen = 7)
# width + heights figures constants
dkfigwidth <- 5
dkfigheight <- 5
lkfigwidth <- 8
lkfigheight <- 7
```


```{r, warning=FALSE, include=FALSE}
#' Loading packages and code
#' ================

library(dplyr)
library(ggplot2)

#' Sourcing more code
#' ================
#'
# more code
# workdir <- getwd()
maindir <- ".."
mcodir <- "addcode"
code1name <- "utils.R"
source(file.path(maindir, mcodir, code1name))

# more code :  standard functions
stdfundir <- "standardfunctions"
stdfunname <- "standardfunctionsV4.R"
source(file.path(maindir, stdfundir, stdfunname))

# more code: results storing and retrieving

rdirect <- "rcode"
codresultats <- "coderesultats.R"
codepath <- file.path(maindir, rdirect, codresultats)
source(file.path(maindir, rdirect, codresultats))

```


```{r getdata}
#'
#' Récupération des données prétraitées
#' ====================================
#'

# path(rda)
datadir2 <- "data2"
alldatapath <- file.path(maindir, datadir2, "alldata.Rda")
# loading
whatload <- load(alldatapath)
# verification
# whatload
```


```{r getallresults}
#'
#' lecture des résultats de traitement
#' ====================================
#'

# path(rda)
datadir3 <- "data3"
allresultspath <- file.path(maindir, datadir3, "allresults.Rda")
message(getwd())
message(allresultspath)
# loading
whatload <- load(allresultspath)
# verification
whatload
```





Les données
===========

```{r studydata}
# nombre de diplômés 
ndip <- nrow(maindf)
nfiliere =length(levels(maindf$filiere)) 
nrep <- nrow(repdf)
trep <- nrep / ndip

```

L'enquête Jeunes Diplômés 2015 a été administrée aux diplômés de la promotion 2015 en mai et juin 2016, par voie électronique, suivie d'une relance téléphonique.

Les diplômés de la promotion étaient donc sur le marché du travail depuis environ 7 mois (le jury de diplôme ayant eu lieu en octobre)

Les diplômés de la promotion 2015 sont au nombre de `r ndip`, répartis en `r nfiliere` filières de spécialisation et cursus de double diplôme.
Le nombre de répondants à l'enquête est de `r nrep`, soit un taux de réponse de `r trep*100` %.

```{r filierescomp, fig.height=lkfigheight, fig.widtht = lkfigwidth}
# lkfigwidth
# lkfigheight
fpromo <- cat1(dataf=maindf, nomfact="filiere", useNA = "no",
                                    orderfreq = TRUE,
                                    rfreq = FALSE, digits = 2, cfill = "steelblue")


maindf[["filiere"]] <- orderfact(maindf, nomfact="filiere", nlevels = fpromo$levels)
repdf[["filiere"]] <- orderfact(repdf, nomfact="filiere", nlevels = fpromo$levels)

t1 <- table(maindf$filiere)
tdf <- as.data.frame(t1)
t2 <- table(repdf$filiere)
t2df <- as.data.frame(t2)

tcomp <- full_join(tdf, t2df, "Var1")
colnames(tcomp) <- c("filière", "Nombre de diplômés", "Nombre de répondants")

# table :
kable(tcomp, caption="Diplômés et répondants par spécialisation")

# Graphique : faire un facteur et ordonner en sens inverse les niveaux
maindf$rep <- ifelse(maindf$repondant, "Répondant", "Nonrépondant")
maindf$rep <- orderfact(maindf,"rep", nlevels = c("Répondant", "Nonrépondant"))
# plot
ggplot(maindf[which(!is.na(maindf[["filiere"]])), ], 
       aes(filiere, fill = rep)) + geom_bar(position="stack")+
        theme(axis.text.x = element_text(angle=90, hjust=1)) +
        scale_fill_discrete(guide = guide_legend(title = "",reverse = TRUE))+
        labs(x="", y= "Effectif", title= "Répondants par spécialisation" )

# test
set.seed(1000)
pval <- chisq.test(x= tcomp[["Nombre de répondants"]], p=tcomp[["Nombre de diplômés"]], rescale.p = TRUE, simulate.p.value = TRUE)$p.value

```

La distribution des filières des répondants ne diffère pas significativement de celle des diplômés (p-valeur = `r 100* pval` %, obtenue par simulation)
On peut donc considérer que l'échantillon des répondants représente bien l'ensemble des spécialisations.




La fin d'études et les contacts avec le monde professionnel : Stage et Alternance
=================================================================================


Le stage de fin d'études 
------------------------

### Q10 Avez-vous reçu une proposition d’embauche de votre entreprise d'accueil à l’issue de votre stage de fin d'études ?{-}


```{r stg_fin_etude_proposition}
res <- getresult("stg_fin_etude_proposition")
numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```

La différence des fréquences est significative (Chi² : p-valeur = `r pval*100`%)

```{r}
plot2 <- plot + labs(x = "", y = "Poucent", title = "Proposition d'embauche en fin de stage ?")
plot2

```

### 11 Avez-vous accepté cette proposition ? {-}
[Répondez seulement à cette question si vous avez répondu 'Oui' à la question 'stg_fin_etude_proposition']

```{r stg_fin_etude_accepte}
res <- getresult("stg_fin_etude_accepte")

numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
plot <- res$plot
```

Il y a `r numc` répondants à cette question

Table des réponses:  

```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```

La différence des fréquences est peu significative (Chi² : p-valeur = `r pval*100`%)

```{r}
plot2 <- plot + 
        labs(x = " ", y = "Poucent", title = "Avez-vous accepté ?")
plot2

```

### 12 Pour quelle(s) raison(s) avez-vous refusé cette proposition ? 
[Répondez seulement à cette question si vous avez répondu 'Non' à la question 'stg_fin_etude_accepte']

```{r}
res <- getresult("stg_fin_etude_raison_refus")
numc <- res$numcases
ptable <- res$ptable

```
Il y a `r numc` répondants

```{r}
kable(ptable, caption = "Raisons du refus")
```



L'accès à l'emploi par l'Alternance
-----------------------------------

### 13 Avez-vous suivi un cursus en alternance à l’IPAG ? {-}


```{r alternance_cursus}
res <- getresult("alternance_cursus")

numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```

<!-- La différence des fréquences est significative (Chi² : p-valeur = `r pval*100`%) -->

```{r}
plot2 <- plot + labs(x = "", y = "Poucent")
plot2

```

### 14 Dans le cadre de cette alternance, quel type de contrat avez-vous signé ? {-} 

```{r}
res <- getresult("alternance_type")
numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```

<!-- La différence des fréquences est significative (Chi² : p-valeur = `r pval*100`%) -->

```{r}
plot2 <- plot + labs(x = "", y = "Poucent")
plot2

```


### 15 Avez-vous reçu une proposition d'embauche de la part de l'entreprise, à la fin de votre contrat en alternance ? {-}


```{r}
res <- getresult("alternance_proposition")

numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```

<!-- La différence des fréquences est significative (Chi² : p-valeur = `r pval*100`%) -->

```{r}
plot2 <- plot + labs(x = "", y = "Poucent")
plot2

```

### 16 Est-ce pour poursuivre la mission sur laquelle vous avez travaillé pendant votre alternance ? {-}


```{r}
res <- getresult("alternance_proposition")

numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```

<!-- La différence des fréquences est significative (Chi² : p-valeur = `r pval*100`%) -->

```{r}
plot2 <- plot + labs(x = "", y = "Poucent")
plot2

```

### 17 Si vous n'avez pas eu de proposition d'embauche, savez-vous pour quelle(s) raison(s) ? {-}


```{r}
res <- getresult("alternance_pas_proposition")

numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```

<!-- La différence des fréquences est significative (Chi² : p-valeur = `r pval*100`%) -->

```{r}
plot2 <- plot + labs(x = "", y = "Poucent")
plot2 + theme(axis.text.x = element_text(angle=33, hjust=1))

```


### 18 Si vous avez eu une proposition d'embauche, Avez-vous accepté cette proposition ? {-} 

```{r}
res <- getresult("alternance_accepter")

numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```

<!-- La différence des fréquences est significative (Chi² : p-valeur = `r pval*100`%) -->

```{r}
plot2 <- plot + labs(x = "", y = "Poucent")
plot2 

```

### Si vous avez refusé cette proposition, Pour quelle raison  ? {-} 


```{r}
res <- getresult("alternance_refus")

numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```

<!-- La différence des fréquences est significative (Chi² : p-valeur = `r pval*100`%) -->

```{r}
plot2 <- plot + labs(x = "", y = "Poucent")
plot2 + theme(axis.text.x = element_text(angle=33, hjust=1))

```



Situation actuelle des diplômés
===============================

### 20 Votre situation actuelle {-}


```{r}
res <- getresult("situation_situation")

numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
seuilsignif <- 0.05
seuilpeusignif <- 0.1
estsignif <- ifelse(pval < seuilsignif,"est", ifelse(pval < seuilpeusignif,"est peu", "n'est pas"))


plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```
<!-- -->
La différence des effectifs des catégories `r estsignif` significative (Chi² : p-valeur = `r pval*100`%) 

```{r}
plot2 <- plot + labs(x = "", y = "Poucent")
plot2 + theme(axis.text.x = element_text(angle=33, hjust=1))

```

Les diplômés qui effectuent un volontariat
-------------------------------------------

### 21 Si vous êtes en activité professionnelle, êtes_vous volontaire (VIE, VIA) ? {-}

```{r}
res <- getresult("situation_volontariat")

numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
seuilsignif <- 0.05
seuilpeusignif <- 0.1
estsignif <- ifelse(pval < seuilsignif,"est", ifelse(pval < seuilpeusignif,"est peu", "n'est pas"))


plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```
<!-- -->

<!-- La différence des effectifs des catégories `r estsignif` significative (Chi² : p-valeur = `r pval*100`%) --> 

```{r}
plot2 <- plot + labs(x = "", y = "Poucent")
plot2

```


### 22 Si vous êtes volontaire, De quel type de volontariat s'agit-il ? {-}


```{r}
res <- cat1(dataf=maindf, nomfact="situation_volontariat_type", useNA = "no",
                                    orderfreq = FALSE,
                                    rfreq = TRUE, digits = 2, cfill = "steelblue")

numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
seuilsignif <- 0.05
seuilpeusignif <- 0.1
estsignif <- ifelse(pval < seuilsignif,"est", ifelse(pval < seuilpeusignif,"est peu", "n'est pas"))


plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```
<!-- -->

<!-- La différence des effectifs des catégories `r estsignif` significative (Chi² : p-valeur = `r pval*100`%) --> 

```{r}
plot2 <- plot + labs(x = "", y = "Poucent")
plot2

```


Les créateurs d'entreprise
--------------------------

### 23 Si vous êtes en création d'entreprise, L'entreprise st-elle déjà en activité ? *

* Si l'entreprise en création est déjà en activité, vous serez considéré(e) comme étant vous-même en activité professionnelle.

```{r}
res <- cat1(dataf=maindf, nomfact="situation_creation_activite", useNA = "no",
                                    orderfreq = FALSE,
                                    rfreq = TRUE, digits = 2, cfill = "steelblue")

numc <- res$numcases
ptable <- res$ptable
colnames(ptable) <- c("Réponse", "Effectif", "%")
pval <- res$chi2$test1$p.value
seuilsignif <- 0.05
seuilpeusignif <- 0.1
estsignif <- ifelse(pval < seuilsignif,"est", ifelse(pval < seuilpeusignif,"est peu", "n'est pas"))


plot <- res$plot
```

Il y a `r numc` répondants à cette question


```{r}

kable(ptable, caption = "Table des réponses", align = 'c', digits = 2)
```

<!-- La différence des effectifs des catégories `r estsignif` significative (Chi² : p-valeur = `r pval*100`%) --> 

```{r}
plot2 <- plot + labs(x = "", y = "Poucent")
plot2

```


